SELECT B.id, 
       B.name,
			 B.address,
			 B.city,
			 B.state,
			 B.postal_code,
			 B.latitude,
			 B.longitude,
			 B.review_count,
			 B.stars,
			 
MAX(CASE WHEN H.hours LIKE "%monday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS monday_hours,

MAX(CASE WHEN H.hours LIKE "%tuesday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS tuesday_hours,

MAX(CASE WHEN H.hours LIKE "%wednesday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS wednesday_hours,

MAX(CASE WHEN H.hours LIKE "%thursday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS thursday_hours,

MAX(CASE WHEN H.hours LIKE "%friday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS friday_hours,

MAX(CASE WHEN H.hours LIKE "%saturday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS saturday_hours,

MAX(CASE WHEN H.hours LIKE "%sunday%" THEN TRIM(H.hours,'%MondayTuesWednesThursFriSatSun|%') END) AS sunday_hours

--GROUP_CONCAT(DISTINCT(C.category)) AS categories,
--GROUP_CONCAT(DISTINCT(A.name)) AS attributes,

--B.is_open

FROM business B
INNER JOIN hours H
ON B.id = H.business_id
INNER JOIN category C
ON B.id = C.business_id
INNER JOIN attribute A
ON B.id = A.business_id
GROUP BY B.id
